# 입력: 행렬 A, 초기벡터 x, 이동변수 alpha, 최대 반복횟수 kmax
# 출력: 우세 고유값, 우세 고유벡터

import numpy as np
def inversepower(A, x, kmax, alpha):
    m, n = A.shape
    if m != n:
        print('정방행렬이 아님')

    #단위행렬 eye
    B = A - np.eye(m) * alpha

    for k in range(0, kmax):
        #y를 가우스소거법, 부분피벗가우스소거법을 이용할 수 있음 but 선형방정식 푸는 numpy 코드가 있음
        y = np.linalg.solve(B, x) #B*y = x
        # # 1차 방법: y값에 절대값을 취하고 그 중 가장 큰 값
        # index = np.argmax(np.abs(y)) # 절대값이 최대값인 인덱스
        # value = y[index] # value: 우세고유값
        # vector = y / value #y값을 value로 나눈다. #vector: 우세 고유 벡터

        # 2차 방법 - 내적한다.
        value = np.dot(x, y) #고유값
        vector = y / np.linalg.norm(y) # 고유벡터
        value = (1.0 / value) + alpha
        print('k = {0} \t 고유값 = {1} \t 고유벡터 = {2}'.format(k, value, vector))#k, value, vector값이 변하는 것이 들어가게 됨.
        x  = np.copy(vector)
    return value, vector

#power 함수 정의 완료

A = np.array([[2.0, -1.0, 1.0], [-1.0, 1.0, -2.0], [1.0, -2.0, 1.0]])
x = np.array([1.0, 1.0, 1.0])
kmax = 100
alpha = -0.5
# alpha = 0 ##1과 -1사이라서 어느쪽으로 갈지 수렴할 수 없음
# alpha = 2
a, b = inversepower(A, x, kmax, alpha) #a: 우세고유값, b: 우세고유벡터
print(a)
print(b)

w, V = np.linalg.eig(A)
print(w)
print(V)
## alpha가 2일 때
# k = 0 	 고유값 = 1.1428571428571428 	 고유벡터 = [-0.50709255 -0.84515425  0.16903085]
# k = 1 	 고유값 = 0.609271523178808 	 고유벡터 = [ 0.88871583  0.42790021 -0.164577  ]
# k = 2 	 고유값 = 0.9281981807625312 	 고유벡터 = [-0.76094085 -0.5016573   0.41147172]
# k = 3 	 고유값 = 0.985501017990771 	 고유벡터 = [ 0.84099915  0.39737446 -0.36717022]
# k = 4 	 고유값 = 0.9967628130024353 	 고유벡터 = [-0.80352227 -0.42593136  0.41585387]
# k = 5 	 고유값 = 0.9992335338040195 	 고유벡터 = [ 0.82282292  0.40352368 -0.40016382]
# k = 6 	 고유값 = 0.9998131201238085 	 고유벡터 = [-0.81329448 -0.41199133  0.41087132]
# k = 7 	 고유값 = 0.9999538047872716 	 고유벡터 = [ 0.81808815  0.40683867 -0.40646534]
# k = 8 	 고유값 = 0.9999885094034906 	 고유벡터 = [-0.81569844 -0.40910748  0.40898304]
# k = 9 	 고유값 = 0.9999971338119753 	 고유벡터 = [ 0.81689507  0.40787025 -0.40782877]
# k = 10 	 고유값 = 0.9999992841704977 	 고유벡터 = [-0.81629719 -0.40845452  0.40844069]
# k = 11 	 고유값 = 0.9999998211223224 	 고유벡터 = [ 0.81659624  0.40815092 -0.40814631]
# k = 12 	 고유값 = 0.9999999552894345 	 고유벡터 = [-0.81644674 -0.40829889  0.40829736]
# k = 13 	 고유값 = 0.9999999888233424 	 고유벡터 = [ 0.8165215   0.40822363 -0.40822312]
# k = 14 	 고유값 = 0.999999997205945 	 고유벡터 = [-0.81648412 -0.40826083  0.40826066]
# k = 15 	 고유값 = 0.9999999993014981 	 고유벡터 = [ 0.81650281  0.40824209 -0.40824203]
# k = 16 	 고유값 = 0.9999999998253759 	 고유벡터 = [-0.81649347 -0.40825141  0.4082514 ]
# k = 17 	 고유값 = 0.999999999956344 	 고유벡터 = [ 0.81649814  0.40824674 -0.40824673]
# k = 18 	 고유값 = 0.9999999999890861 	 고유벡터 = [-0.8164958  -0.40824907  0.40824907]
# k = 19 	 고유값 = 0.9999999999972713 	 고유벡터 = [ 0.81649697  0.4082479  -0.4082479 ]
# k = 20 	 고유값 = 0.9999999999993181 	 고유벡터 = [-0.81649639 -0.40824849  0.40824849]
# k = 21 	 고유값 = 0.9999999999998295 	 고유벡터 = [ 0.81649668  0.40824819 -0.40824819]
# k = 22 	 고유값 = 0.9999999999999576 	 고유벡터 = [-0.81649653 -0.40824834  0.40824834]
# k = 23 	 고유값 = 0.9999999999999893 	 고유벡터 = [ 0.81649661  0.40824827 -0.40824827]
# k = 24 	 고유값 = 0.9999999999999973 	 고유벡터 = [-0.81649657 -0.4082483   0.4082483 ]
# k = 25 	 고유값 = 0.9999999999999996 	 고유벡터 = [ 0.81649659  0.40824828 -0.40824828]
# k = 26 	 고유값 = 1.0 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 27 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 28 	 고유값 = 1.0000000000000004 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 29 	 고유값 = 0.9999999999999998 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 30 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 31 	 고유값 = 1.0000000000000004 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 32 	 고유값 = 0.9999999999999998 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 33 	 고유값 = 1.0 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 34 	 고유값 = 1.0 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 35 	 고유값 = 1.0 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 36 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 37 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 38 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 39 	 고유값 = 1.0000000000000004 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 40 	 고유값 = 0.9999999999999998 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 41 	 고유값 = 1.0 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 42 	 고유값 = 1.0 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 43 	 고유값 = 0.9999999999999998 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 44 	 고유값 = 1.0 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 45 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 46 	 고유값 = 0.9999999999999998 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 47 	 고유값 = 0.9999999999999998 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 48 	 고유값 = 1.0 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 49 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 50 	 고유값 = 1.0 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 51 	 고유값 = 1.0 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 52 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 53 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 54 	 고유값 = 0.9999999999999998 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 55 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 56 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 57 	 고유값 = 0.9999999999999998 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 58 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 59 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 60 	 고유값 = 0.9999999999999998 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 61 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 62 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 63 	 고유값 = 0.9999999999999998 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 64 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 65 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 66 	 고유값 = 0.9999999999999998 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 67 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 68 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 69 	 고유값 = 0.9999999999999998 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 70 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 71 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 72 	 고유값 = 0.9999999999999998 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 73 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 74 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 75 	 고유값 = 0.9999999999999998 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 76 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 77 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 78 	 고유값 = 0.9999999999999998 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 79 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 80 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 81 	 고유값 = 0.9999999999999998 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 82 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 83 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 84 	 고유값 = 0.9999999999999998 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 85 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 86 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 87 	 고유값 = 0.9999999999999998 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 88 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 89 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 90 	 고유값 = 0.9999999999999998 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 91 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 92 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 93 	 고유값 = 0.9999999999999998 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 94 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 95 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 96 	 고유값 = 0.9999999999999998 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 97 	 고유값 = 1.0000000000000002 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# k = 98 	 고유값 = 1.0000000000000002 	 고유벡터 = [-0.81649658 -0.40824829  0.40824829]
# k = 99 	 고유값 = 0.9999999999999998 	 고유벡터 = [ 0.81649658  0.40824829 -0.40824829]
# 0.9999999999999998

## 어떤 고유값에 상수를 곱해도 똑같은 고유값이다.
# [ 0.81649658  0.40824829 -0.40824829]
# [ 1.  4. -1.]
# [[-8.16496581e-01 -5.77350269e-01 -8.11722909e-18]
#  [-4.08248290e-01  5.77350269e-01  7.07106781e-01]
#  [ 4.08248290e-01 -5.77350269e-01  7.07106781e-01]]